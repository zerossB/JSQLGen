package gen.mainwindow;

/**
 *
 * @author marcos
 */
public class MainWindowGen {

    private project.Project proj;

    /**
     * Construtor
     * @param proj
     */
    public MainWindowGen(project.Project proj){
        this.proj = proj;
    }


    public String getJavaCode(){
        String code = "";
        code += "package "+proj.getName().toLowerCase()+";\n";
        code += "\n";
        code += "/**\n";
        code += " *\n";
        code += " * @author jsqlgen\n";
        code += " */\n";
        code += "public class MainWindow extends javax.swing.JFrame {\n";
        code += "\n";
        code += "    private dbaccess.DBAccess dbAccess;\n";

        code += "\n";
        code += "    /** Creates new form MainWindow */\n";
        code += "    public MainWindow() {\n";
        code += "        try {\n";
        code += "            dbAccess = new dbaccess.DBAccess();\n";
        code += "            initComponents();\n";
        code += "            this.setVisible(true);\n";
        code += "        } catch(ClassNotFoundException e){\n";
        code += "            e.printStackTrace();\n";
        code += "            javax.swing.JOptionPane.showMessageDialog(this, \"Erro ao carregar driver JDBC\", \"Erro\", javax.swing.JOptionPane.ERROR_MESSAGE);\n";
        code += "            System.exit(1);\n";
        code += "        } catch(java.sql.SQLException e){\n";
        code += "            e.printStackTrace();\n";
        code += "            javax.swing.JOptionPane.showMessageDialog(this, \"Erro ao conectar no Banco de Dados\", \"Erro\", javax.swing.JOptionPane.ERROR_MESSAGE);\n";
        code += "            System.exit(2);\n";
        code += "        }\n";
        code += "    }\n";

        code += "\n";
        code += "    /** This method is called from within the constructor to\n";
        code += "     * initialize the form.\n";
        code += "     * WARNING: Do NOT modify this code. The content of this method is\n";
        code += "     * always regenerated by the Form Editor.\n";
        code += "     */\n";
        code += "    @SuppressWarnings(\"unchecked\")\n";
        code += "    // <editor-fold defaultstate=\"collapsed\" desc=\"Generated Code\">//GEN-BEGIN:initComponents\n";
        code += "    private void initComponents() {\n";
        code += "        menuBar = new javax.swing.JMenuBar();\n";
        code += "        mArquivo = new javax.swing.JMenu();\n";
        for(project.ClassBean classBean : proj.getClassBeans()){
            if(!classBean.isDependent(proj))
                code += "        m"+classBean.getName()+" = new javax.swing.JMenuItem();\n";
        }
        code += "        jSeparator1 = new javax.swing.JPopupMenu.Separator();\n";
        code += "        mSair = new javax.swing.JMenuItem();\n";
        code += "        mRelatorio = new javax.swing.JMenu();\n";
        code += "        mSQLViewer = new javax.swing.JMenuItem();\n";
        code += "        setDefaultCloseOperation(javax.swing.WindowConstants.DO_NOTHING_ON_CLOSE);\n";
        code += "        setExtendedState(MAXIMIZED_BOTH);\n";
        code += "        addWindowListener(new java.awt.event.WindowAdapter() {\n";
        code += "            public void windowClosing(java.awt.event.WindowEvent evt) {\n";
        code += "                formWindowClosing(evt);\n";
        code += "            }\n";
        code += "        });\n";
        code += "        mArquivo.setMnemonic('A');\n";
        code += "        mArquivo.setText(\"Arquivo\");\n";

        for(project.ClassBean classBean : proj.getClassBeans()){
            if(!classBean.isDependent(proj)){
                code += "        m"+classBean.getName()+".setText(\""+classBean.getName()+"\");\n";
                code += "        m"+classBean.getName()+".addActionListener(new java.awt.event.ActionListener() {\n";
                code += "            public void actionPerformed(java.awt.event.ActionEvent evt) {\n";
                code += "                m"+classBean.getName()+"ActionPerformed(evt);\n";
                code += "            }\n";
                code += "        });\n";
                code += "        mArquivo.add(m"+classBean.getName()+");\n";
            }
        }

        code += "        mArquivo.add(jSeparator1);\n";
        code += "        mSair.setText(\"Sair\");\n";
        code += "        mSair.addActionListener(new java.awt.event.ActionListener() {\n";
        code += "            public void actionPerformed(java.awt.event.ActionEvent evt) {\n";
        code += "                mSairActionPerformed(evt);\n";
        code += "            }\n";
        code += "        });\n";
        code += "        mArquivo.add(mSair);\n";
        code += "        menuBar.add(mArquivo);\n";
        code += "        mRelatorio.setMnemonic('R');\n";
        code += "        mRelatorio.setText(\"Relatórios\");\n";
        code += "        mSQLViewer.setText(\"Consulta SQL\");\n";
        code += "        mSQLViewer.addActionListener(new java.awt.event.ActionListener() {\n";
        code += "            public void actionPerformed(java.awt.event.ActionEvent evt) {\n";
        code += "                mSQLViewerActionPerformed(evt);\n";
        code += "            }\n";
        code += "        });\n";
        code += "        mRelatorio.add(mSQLViewer);\n";
        code += "        menuBar.add(mRelatorio);\n";
        code += "        setJMenuBar(menuBar);\n";
        code += "        java.awt.Dimension screenSize = java.awt.Toolkit.getDefaultToolkit().getScreenSize();\n";
        code += "        setBounds((screenSize.width-800)/2, (screenSize.height-600)/2, 800, 600);\n";
        code += "    }// </editor-fold>//GEN-END:initComponents\n";
        code += "\n";
        code += "    private void formWindowClosing(java.awt.event.WindowEvent evt) {//GEN-FIRST:event_formWindowClosing\n";
        code += "        if(javax.swing.JOptionPane.showConfirmDialog(this, \"Deseja sair?\", \"Questão\", javax.swing.JOptionPane.OK_CANCEL_OPTION, javax.swing.JOptionPane.QUESTION_MESSAGE) == javax.swing.JOptionPane.OK_OPTION){\n";
        code += "            try{\n";
        code += "                dbAccess.disconnect();\n";
        code += "                this.dispose();\n";
        code += "                System.exit(0);\n";
        code += "            } catch(java.sql.SQLException e){\n";
        code += "                javax.swing.JOptionPane.showMessageDialog(this, \"Erro ao desconectar no Banco de Dados\", \"Erro\", javax.swing.JOptionPane.ERROR_MESSAGE);\n";
        code += "            }\n";
        code += "            this.dispose();\n";
        code += "        }\n";
        code += "    }//GEN-LAST:event_formWindowClosing\n";

        code += "\n";
        code += "    private void mSairActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_mSairActionPerformed\n";
        code += "        formWindowClosing(null);\n";
        code += "    }//GEN-LAST:event_mSairActionPerformed\n";

        code += "\n";
        code += "    private void mSQLViewerActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_mSQLViewerActionPerformed\n";
        code += "        new toolbox.SQLViewer(this, dbAccess.getConnection());\n";
        code += "    }//GEN-LAST:event_mSQLViewerActionPerformed\n";
        code += "\n";
        
        for(project.ClassBean classBean : proj.getClassBeans()){
            if(!classBean.isDependent(proj)){
                code += "    private void m"+classBean.getName()+"ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_m"+classBean.getName()+"ActionPerformed\n";
                code += "        new "+classBean.getPackage(proj) +"."+classBean.getName()+"Tab(this, dbAccess.getConnection());\n";
                code += "    }//GEN-LAST:event_m"+classBean.getName()+"ActionPerformed\n";
                code += "\n";
            }
        }
        code += "\n";
        code += "    /**\n";
        code += "     * @param args the command line arguments\n";
        code += "     */\n";
        code += "    public static void main(String args[]) {\n";
        code += "        java.awt.EventQueue.invokeLater(new Runnable() {\n";
        code += "            public void run() {\n";
        code += "                new MainWindow();\n";
        code += "            }\n";
        code += "        });\n";
        code += "    }\n";
        code += "\n";
        code += "    // Variables declaration - do not modify//GEN-BEGIN:variables\n";
        code += "    private javax.swing.JPopupMenu.Separator jSeparator1;\n";
        code += "    private javax.swing.JMenu mArquivo;\n";
        for(project.ClassBean classBean : proj.getClassBeans()){
            if(!classBean.isDependent(proj))
                code += "    private javax.swing.JMenuItem m"+classBean.getName()+";\n";
        }
        code += "    private javax.swing.JMenu mRelatorio;\n";
        code += "    private javax.swing.JMenuItem mSQLViewer;\n";
        code += "    private javax.swing.JMenuItem mSair;\n";
        code += "    private javax.swing.JMenuBar menuBar;\n";
        code += "    // End of variables declaration//GEN-END:variables\n";
        code += "\n";
        code += "}\n";
        return code;
    }

}
